<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registrar Nuevo Auditor - Gestión Salesland</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <style>
        :root { /* ... (Copia TODOS los :root y html[data-theme="dark"] de login.html) ... */
             --primary-color-light: #074F69; --secondary-color-light: #053a4e; --bg-color-light: #f0f2f5; --text-color-light: #212529; --card-bg-light: #fff; --input-bg-light: #fff; --input-text-light: #495057; --input-border-light: #ced4da; --link-color-light: var(--primary-color-light); --effective-primary-color-rgb: 7, 79, 105; --effective-primary-color: var(--primary-color-light); --effective-secondary-color: var(--secondary-color-light); --effective-bg-color: var(--bg-color-light); --effective-text-color: var(--text-color-light); --effective-card-bg: var(--card-bg-light); --effective-input-bg: var(--input-bg-light); --effective-input-text: var(--input-text-light); --effective-input-border: var(--input-border-light); --effective-link-color: var(--link-color-light);
        }
        html[data-theme="dark"] {
             --primary-color-dark: #5096dc; --secondary-color-dark: #3b7cb8; --bg-color-dark: #131314; --text-color-dark: #e8eaed; --card-bg-dark: #1e1f20; --input-bg-dark: #2a2b2c; --input-text-dark: #e8eaed; --input-border-dark: #5f6368; --link-color-dark: #8ab4f8; --effective-primary-color-rgb: 80, 150, 220; --effective-primary-color: var(--primary-color-dark); --effective-secondary-color: var(--secondary-color-dark); --effective-bg-color: var(--bg-color-dark); --effective-text-color: var(--text-color-dark); --effective-card-bg: var(--card-bg-dark); --effective-input-bg: var(--input-bg-dark); --effective-input-text: var(--input-text-dark); --effective-input-border: var(--input-border-dark); --effective-link-color: var(--link-color-dark);
        }
         body { background-color: var(--effective-bg-color); color: var(--effective-text-color); font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; align-items: center; justify-content: center; min-height: 100vh; padding-top: 2rem; padding-bottom: 2rem; transition: background-color 0.3s, color 0.3s; }
        .register-card { width: 100%; max-width: 500px; padding: 30px; background-color: var(--effective-card-bg); border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.08); border: 1px solid var(--effective-input-border); transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s; }
        html[data-theme="dark"] .register-card { box-shadow: 0 1px 2px 0 rgba(0,0,0,.6), 0 1px 3px 1px rgba(0,0,0,.3); }
        .register-card .logo-placeholder { width: 70px; height: 70px; background-color: var(--effective-primary-color); color: #fff; border-radius: 50%; margin: 0 auto 25px auto; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.8em; }
        html[data-theme="dark"] .register-card .logo-placeholder { color: #131314; }
        .form-label { color: var(--effective-text-color); }
        .form-control, .form-select { background-color: var(--effective-input-bg); color: var(--effective-input-text); border: 1px solid var(--effective-input-border); }
        .form-control::placeholder { color: var(--effective-input-text); opacity: 0.7; }
        html[data-theme="dark"] .form-control::placeholder, html[data-theme="dark"] .form-select { color: var(--input-text-dark); opacity: 0.5; }
        html[data-theme="dark"] .form-select option { background-color: var(--input-bg-dark); color: var(--input-text-dark); }
        .form-control:focus, .form-select:focus { background-color: var(--effective-input-bg); color: var(--effective-input-text); border-color: var(--effective-primary-color); box-shadow: 0 0 0 0.25rem rgba(var(--effective-primary-color-rgb), 0.25); }
        .btn-primary { background-color: var(--effective-primary-color); border-color: var(--effective-primary-color); color: #fff; transition: background-color 0.3s, border-color 0.3s, filter 0.3s; }
        html[data-theme="dark"] .btn-primary { color: #131314; }
        .btn-primary:hover { filter: brightness(90%); }
        html[data-theme="dark"] .btn-primary:hover { filter: brightness(110%); }
        .register-card a { color: var(--effective-link-color); text-decoration: none; }
        .register-card a:hover { text-decoration: underline; }
        .invalid-feedback { color: #dc3545; }
        html[data-theme="dark"] .invalid-feedback { color: #f17070; }
        .alert { background-color: var(--effective-card-bg); border: 1px solid var(--effective-input-border); color: var(--effective-text-color); }
        .alert-danger { background-color: rgba(220, 53, 69, 0.1); border-color: rgba(220, 53, 69, 0.3); color: #b02a37; }
        html[data-theme="dark"] .alert-danger { background-color: rgba(241, 112, 112, 0.15); border-color: rgba(241, 112, 112, 0.4); color: #f19494; }
        .btn-close { filter: invert(0.5) sepia(1) saturate(0) hue-rotate(0deg); }
        html[data-theme="dark"] .btn-close { filter: invert(1) grayscale(100%) brightness(200%); }
    </style>
</head>
<body>
    <div class="register-card">
        <div class="logo-placeholder"><span>P</span></div>
        <h3 class="text-center mb-4">Registrar Nueva Cuenta</h3>
        <p class="text-center text-muted small mb-4">Las cuentas nuevas se crean con rol de Administrador. Un administrador existente puede cambiar el rol más tarde.</p>


        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <form method="POST" action="{{ url_for('register') }}" id="registerForm" novalidate>
            <div class="mb-3">
                <label for="nombre_completo" class="form-label">Nombre Completo</label>
                <input type="text" class="form-control" id="nombre_completo" name="nombre_completo" value="{{ request.form.nombre_completo }}" required>
                <div class="invalid-feedback">El nombre completo es obligatorio.</div>
            </div>
            <div class="mb-3">
                <label for="dni_auditor" class="form-label">DNI del Auditor (8 o 9 dígitos)</label>
                <input type="text" class="form-control" id="dni_auditor" name="dni_auditor" value="{{ request.form.dni_auditor }}" required maxlength="9">
                <div class="invalid-feedback">El DNI debe tener 8 o 9 dígitos numéricos.</div>
            </div>
            <div class="mb-3">
                <label for="correo" class="form-label">Correo Electrónico</label>
                <input type="email" class="form-control" id="correo" name="correo" value="{{ request.form.correo }}" required>
                 <div class="invalid-feedback">Ingrese un correo válido.</div>
            </div>
            <div class="mb-3">
                <label for="contrasena" class="form-label">Contraseña</label>
                <input type="password" class="form-control" id="contrasena" name="contrasena" required>
                 <div class="invalid-feedback">La contraseña es obligatoria.</div>
            </div>
            <div class="mb-3">
                <label for="confirmar_contrasena" class="form-label">Confirmar Contraseña</label>
                <input type="password" class="form-control" id="confirmar_contrasena" name="confirmar_contrasena" required>
                <div class="invalid-feedback">Confirme su contraseña. Si no coinciden, se mostrará un error.</div>
            </div>

            <div class="d-grid mt-4">
                <button type="submit" class="btn btn-primary btn-lg">Registrar Cuenta</button>
            </div>
            <p class="text-center mt-3">
                ¿Ya tienes cuenta? <a href="{{ url_for('login') }}">Inicia Sesión aquí</a>
            </p>
        </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // ... (Tu script de tema y validación existente, sin cambios) ...
        function setTheme(theme) { document.documentElement.setAttribute('data-theme', theme); localStorage.setItem('theme', theme); }
        let initialTheme = localStorage.getItem('theme');
        if (!initialTheme) { initialTheme = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'; }
        setTheme(initialTheme);
        const dniAuditorInput = document.getElementById('dni_auditor');
        dniAuditorInput.addEventListener('input', function(event) { this.value = this.value.replace(/\D/g, ''); });
        (() => { 'use strict'; const forms = document.querySelectorAll('.needs-validation, #registerForm'); Array.from(forms).forEach(form => { form.addEventListener('submit', event => { if (!form.checkValidity()) { event.preventDefault(); event.stopPropagation(); } const dniValue = dniAuditorInput.value.trim(); if (!/^\d{8,9}$/.test(dniValue) && dniValue !== "") { dniAuditorInput.classList.add('is-invalid'); dniAuditorInput.classList.remove('is-valid'); event.preventDefault(); event.stopPropagation(); } else if (dniValue !== "") { dniAuditorInput.classList.remove('is-invalid'); dniAuditorInput.classList.add('is-valid'); } form.classList.add('was-validated'); }, false); }); })();
    </script>
</body>
</html>